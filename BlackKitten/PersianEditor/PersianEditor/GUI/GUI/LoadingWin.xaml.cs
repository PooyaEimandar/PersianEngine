/*
 * Copyright (c) BaziPardaz.Co Ltd. All rights reserved.
 * 
 * File Name        : LoadingWin.cs
 * File Description : The loading window
 * Generated by     : Pooya Eimandar
 * Last modified by : Pooya Eimandar on 8/30/2013
 * Comment          : 
 */

using System;
using System.Windows;

namespace PersianEditor.Windows
{
    public partial class LoadingWin : Window, IDisposable
    {
        #region Fields

        bool isDisposed;
        DateTime StartTime;
        TimeSpan HowLongWait;
        System.Windows.Forms.Timer timer;

        #endregion

        #region Constructor/Destructor

        public LoadingWin()
        {
            InitializeComponent();
            this.isDisposed = false;
            timer = new System.Windows.Forms.Timer();
            timer.Interval = 1000;
            timer.Tick += new EventHandler(timer_Tick);
            timer.Start();
            StartTime = DateTime.Now;
        }

        ~ LoadingWin()
        {
            Dispose(false);
        }

        #endregion

        #region Events

        private void timer_Tick(object source, EventArgs e)
        {
            HowLongWait = DateTime.Now.Subtract(StartTime);
            if (HowLongWait.TotalSeconds > 3d)
            {
                timer.Dispose();
                this.Close();
            }
        }

        #endregion

        #region Dispose

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (!isDisposed)
            {
                isDisposed = true;
            }
        }

        #endregion
    }
}
